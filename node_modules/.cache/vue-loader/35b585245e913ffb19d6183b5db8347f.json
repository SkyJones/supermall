{"remainingRequest":"D:\\webStormFile\\vue2\\supermall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\webStormFile\\vue2\\supermall\\src\\views\\Detail\\detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\webStormFile\\vue2\\supermall\\src\\views\\Detail\\detail.vue","mtime":1596937042000},{"path":"D:\\webStormFile\\vue2\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webStormFile\\vue2\\supermall\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webStormFile\\vue2\\supermall\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\webStormFile\\vue2\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webStormFile\\vue2\\supermall\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBkZXRhaWxOYXZCYXIgZnJvbSAiLi9jaGlsZENvbXBzL2RldGFpbE5hdkJhciI7CmltcG9ydCBEZXRhaWxTd2lwZXIgZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbFN3aXBlciI7CmltcG9ydCBEZXRhaWxCYXNlSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsQmFzZUluZm8iOwppbXBvcnQgRGV0YWlsU2hvcEluZm8gZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbFNob3BJbmZvIjsKaW1wb3J0IERldGFpbEdvb2RzSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsR29vZHNJbmZvIjsKaW1wb3J0IERldGFpbFBhcmFtSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsUGFyYW1JbmZvIjsKaW1wb3J0IERldGFpbENvbW1lbmQgZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbENvbW1lbmQiOwppbXBvcnQgR29vZHNMaXN0IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvY29udGVudC9Hb29kcy9Hb29kc0xpc3QiOwppbXBvcnQgRGV0YWlsQm90dG9tQmFyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxCb3R0b21CYXIiOwoKaW1wb3J0IHNjcm9sbCBmcm9tICIuLi8uLi9jb21wb25lbnRzL2NvbW1vbi9zY3JvbGwvc2Nyb2xsIgppbXBvcnQge2dldERldGFpbCwgR29vZHMsIFNob3AsR29vZHNQYXJhbSxnZXRSZWNvbW1lbmR9IGZyb20gIi4uLy4uL25ldHdvcmsvZGV0YWlsIjsKaW1wb3J0IHtpdGVtTGlzdGVuZXJNaXhpbixiYWNrVG9wbWl4fSBmcm9tICIuLi8uLi9jb21tb24vbWl4aW4iOwppbXBvcnQge2RlYm91bmNlfSBmcm9tICIuLi8uLi9jb21tb24vVXRpbHMiOwppbXBvcnQge21hcEFjdGlvbnN9IGZyb20gInZ1ZXgiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJkZXRhaWwiLAogIGNvbXBvbmVudHM6ewogICAgZGV0YWlsTmF2QmFyLAogICAgRGV0YWlsU3dpcGVyLAogICAgRGV0YWlsQmFzZUluZm8sCiAgICBEZXRhaWxTaG9wSW5mbywKICAgIERldGFpbEdvb2RzSW5mbywKICAgIERldGFpbFBhcmFtSW5mbywKICAgIERldGFpbENvbW1lbmQsCiAgICBHb29kc0xpc3QsCiAgICBEZXRhaWxCb3R0b21CYXIsCiAgICBzY3JvbGwsCiAgfSwKICBkYXRhKCl7CiAgICByZXR1cm57CiAgICAgIGlpZDpudWxsLAogICAgICB0b3BJbWFnZXM6W10sCiAgICAgIGdvb2RzOnt9LAogICAgICBzaG9wOnt9LAogICAgICBkZXRhaWxJbmZvOnt9LAogICAgICBwYXJhbUluZm86e30sCiAgICAgIHJlY29tbWVuZDpbXSwKICAgICAgdGhlbWVUb3BZczpbXSwKICAgICAgZ2V0VGhlbWVUb3B5Om51bGwsCiAgICAgIGN1cnJlbnRJbmRleDowLAogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIC8vIOS/neWtmOS8oOWFpeeahGlpZAogICAgdGhpcy5paWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWlkCiAgICAvLyDmoLnmja5paWTor7fmsYLmlbDmja7or6bmg4XpobXnmoTmlbDmja4KICAgIGdldERldGFpbCh0aGlzLmlpZCkudGhlbigocmVzKT0+ewogICAgICBjb25zdCBkYXRhID0gcmVzLnJlc3VsdAogICAgICB0aGlzLnRvcEltYWdlcyA9IGRhdGEuaXRlbUluZm8udG9wSW1hZ2VzCgogICAgICAvLyDojrflj5bllYblk4HmlbDmja4KICAgICAgdGhpcy5nb29kcyA9IG5ldyBHb29kcyhkYXRhLml0ZW1JbmZvLGRhdGEuY29sdW1ucyxkYXRhLnNob3BJbmZvLnNlcnZpY2VzKQogICAgICAvLyDojrflj5blupfpk7rkv6Hmga8KICAgICAgdGhpcy5zaG9wID0gbmV3IFNob3AoZGF0YS5zaG9wSW5mbykKICAgICAgLy8g6I635Y+W5LiL6Z2i55qE6K+m5oOF5L+h5oGvW+WboOS4uui/memHjOeahOaVsOaNruavlOi+g+WNleS4gO+8jOayoeacieS4iumdouS4pOS4quWkjeadgu+8jOaJgOS7peayoeacieeUqOexu+S/neWtmF0KICAgICAgdGhpcy5kZXRhaWxJbmZvID0gZGF0YS5kZXRhaWxJbmZvCiAgICAgIC8vIOiOt+WPluWVhuWTgeWPguaVsOS/oeaBrwogICAgICB0aGlzLnBhcmFtSW5mbyA9IG5ldyBHb29kc1BhcmFtKGRhdGEuaXRlbVBhcmFtcy5pbmZvLGRhdGEuaXRlbVBhcmFtcy5ydWxlKQogICAgfSkKICAgIC8vIOivt+axguivpuaDhemhteS4reaOqOiNkOaVsOaNrgogICAgZ2V0UmVjb21tZW5kKCkudGhlbigocmVzKT0+ewogICAgICB0aGlzLnJlY29tbWVuZCA9IHJlcy5kYXRhLmxpc3QKICAgIH0pCiAgICAvLyDnu5lnZXRUaGVtZVRvcFkg6LWL5YC8CiAgICB0aGlzLmdldFRoZW1lVG9weSA9IGRlYm91bmNlKCgpPT57CiAgICAgIHRoaXMudGhlbWVUb3BZcyA9IFtdCiAgICAgIHRoaXMudGhlbWVUb3BZcy5wdXNoKDApCiAgICAgIHRoaXMudGhlbWVUb3BZcy5wdXNoKHRoaXMuJHJlZnMucGFyYW1zLiRlbC5vZmZzZXRUb3ApCiAgICAgIHRoaXMudGhlbWVUb3BZcy5wdXNoKHRoaXMuJHJlZnMuY29tbWVudC4kZWwub2Zmc2V0VG9wKQogICAgICB0aGlzLnRoZW1lVG9wWXMucHVzaCh0aGlzLiRyZWZzLnJlY29tbWVuZC4kZWwub2Zmc2V0VG9wKQogICAgfSwzMDApCiAgfSwKICAvLyDmt7flhaUKICBtaXhpbnM6W2l0ZW1MaXN0ZW5lck1peGluLGJhY2tUb3BtaXhdLAoKICBtb3VudGVkKCkgewogIH0sCiAgICAvLyDlm6DkuLrov5nph4zmsqHmnInov5vooYznvJPlrZjvvIzmiYDku6XnprvlvIDml7blgJnosIPnlKjnmoTmmK9kZXN0cm95CiAgZGVzdHJveWVkKCkgewogICAgdGhpcy4kYnVzLiRvZmYoJ2ltYWdlTG9hZHMnLHRoaXMuaXRlbUltZ0xpc3RlbmVyKQogIH0sCiAgbWV0aG9kczp7CiAgICAuLi5tYXBBY3Rpb25zKFsnYWRkQ2FydCddKSwKICAgIC8vIERldGFpbC1nb29kcy1pbmZv5Zu+54mH5Yqg6L295Yi35paw5LqL5Lu2CiAgICBpbWFnZUxvYWRlcigpewogICAgICB0aGlzLiRyZWZzLnNjcm9sbGJhY2sucmVmcmVzaAogICAgICAvLyDlm77niYfliqDovb3lrozku6XlkI7ov5vooYzosIPnlKjojrflj5bpq5jluqYKICAgICAgdGhpcy5nZXRUaGVtZVRvcHkoKQogICAgfSwKICAgIC8vIOebkeWQrOWvvOiIquagj+eCueWHu+S6i+S7tgogICAgdGl0bGVDbGlja2VyKGluZGV4KXsKICAgICAgdGhpcy4kcmVmcy5zY3JvbGxiYWNrLnNjcm9sbFRvcygwLC10aGlzLnRoZW1lVG9wWXNbaW5kZXhdLDIwMCkKICAgIH0sCiAgICAvLyDnm5HlkKzpobXpnaLmu5rliqjnmoTml7bpl7QKICAgIGNvbnRlbnRTY3JvbGwocG9zaXRpb24pewogICAgICAvLyDojrflj5Zwb3NpdGlvbuS4reeahHnlgLwKICAgICAgY29uc3QgeSA9IC1wb3NpdGlvbi55CiAgICAgIC8v5Yik5patbmF25ZKM6aG16Z2i55qE5Yy56YWNCiAgICAgIGxldCBsZW5ndGggPSB0aGlzLnRoZW1lVG9wWXMubGVuZ3RoCiAgICAgIGZvciAobGV0IGk9MDtpPGxlbmd0aDtpKyspewogICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCAhPT0gaSAmJiAoaTxsZW5ndGgtMSAmJiB5Pj10aGlzLnRoZW1lVG9wWXNbaV0gJiYgeTx0aGlzLnRoZW1lVG9wWXNbaSsxXSApfHwoaSA9PT0gbGVuZ3RoLTEgJiYKICAgICAgICAgICAgeT49dGhpcy50aGVtZVRvcFlzW2ldKSl7CiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBpCiAgICAgICAgICAgICAgdGhpcy4kcmVmcy5uYXYuY3VycmVudEluZGV4ID0gdGhpcy5jdXJyZW50SW5kZXgKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5saXN0ZW5lclNob3dCYWNrVG9wKHBvc2l0aW9uKQogICAgfSwKICAgIC8vIOebkeWQrOa3u+WKoOWIsOi0reeJqei9pgogICAgYWRkVG9DYXJ0KCl7CiAgICAgIGNvbnN0IHByb2R1Y3QgPSB7fQogICAgICBwcm9kdWN0LmltYWdlID0gdGhpcy50b3BJbWFnZXNbMF0KICAgICAgcHJvZHVjdC50aXRsZSA9IHRoaXMuZ29vZHMudGl0bGUKICAgICAgcHJvZHVjdC5kZXNjID0gdGhpcy5nb29kcy5kZXNjCiAgICAgIHByb2R1Y3QucHJpY2UgPSB0aGlzLmdvb2RzLnJlYWxQcmljZQogICAgICBwcm9kdWN0LmlpZCA9IHRoaXMuaWlkCiAgICAgIC8vIOWwhuWVhuWTgea3u+WKoOWIsOi0reeJqei9pgogICAgICAvLyBBY3Rpb25z6L+U5ZuecHJvbWlzZQogICAgICAvLyB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnYWRkQ2FydCcscHJvZHVjdCkudGhlbihyZXM9PnsKICAgICAgLy8gICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAvLyB9KQoKICAgICAgLy8g5bCG5ZWG5ZOB5re75Yqg5Yiw6LSt54mp6L2m44CQ5L2/55SoQWN0aW9uc+aYoOWwhOOAkQogICAgICB0aGlzLmFkZENhcnQocHJvZHVjdCkudGhlbihyZXM9PnsKICAgICAgICB0aGlzLiR0b2FzdC5zaG93KHJlcywgMTUwMCkKICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"detail.vue","sourceRoot":"src/views/Detail","sourcesContent":["<template>\r\n  <div class=\"details\">\r\n    <detail-nav-bar\r\n            class=\"detail-nav\"\r\n            ref=\"nav\"\r\n            @titleClick=\"titleClicker\">\r\n    </detail-nav-bar>\r\n    <scroll class=\"content\"\r\n            @scroll=\"contentScroll\"\r\n            :probe-type=\"3\"\r\n            ref=\"scrollback\">\r\n      <div>\r\n        <Detail-swiper :top-images=\"topImages\"></Detail-swiper>\r\n        <Detail-base-info :goods=\"goods\"></Detail-base-info>\r\n        <Detail-shop-info :shop=\"shop\"></Detail-shop-info>\r\n        <Detail-goods-info :detail-info=\"detailInfo\" @imageLoad=\"imageLoader\"></Detail-goods-info>\r\n        <Detail-param-info\r\n                ref=\"params\"\r\n                :param-info=\"paramInfo\">\r\n        </Detail-param-info>\r\n        <Detail-commend ref=\"comment\"></Detail-commend>\r\n        <GoodsList\r\n                ref=\"recommend\"\r\n                :goods=\"recommend\">\r\n        </GoodsList>\r\n      </div>\r\n    </scroll>\r\n    <Detail-bottom-bar @addToCart=\"addToCart\"></Detail-bottom-bar>\r\n    <BackTop @click.native=\"backClick()\" v-show=\"isShowBackTop\"></BackTop>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import detailNavBar from \"./childComps/detailNavBar\";\r\n  import DetailSwiper from \"./childComps/DetailSwiper\";\r\n  import DetailBaseInfo from \"./childComps/DetailBaseInfo\";\r\n  import DetailShopInfo from \"./childComps/DetailShopInfo\";\r\n  import DetailGoodsInfo from \"./childComps/DetailGoodsInfo\";\r\n  import DetailParamInfo from \"./childComps/DetailParamInfo\";\r\n  import DetailCommend from \"./childComps/DetailCommend\";\r\n  import GoodsList from \"../../components/content/Goods/GoodsList\";\r\n  import DetailBottomBar from \"./childComps/DetailBottomBar\";\r\n\r\n  import scroll from \"../../components/common/scroll/scroll\"\r\n  import {getDetail, Goods, Shop,GoodsParam,getRecommend} from \"../../network/detail\";\r\n  import {itemListenerMixin,backTopmix} from \"../../common/mixin\";\r\n  import {debounce} from \"../../common/Utils\";\r\n  import {mapActions} from \"vuex\";\r\n\r\n  export default {\r\n    name: \"detail\",\r\n    components:{\r\n      detailNavBar,\r\n      DetailSwiper,\r\n      DetailBaseInfo,\r\n      DetailShopInfo,\r\n      DetailGoodsInfo,\r\n      DetailParamInfo,\r\n      DetailCommend,\r\n      GoodsList,\r\n      DetailBottomBar,\r\n      scroll,\r\n    },\r\n    data(){\r\n      return{\r\n        iid:null,\r\n        topImages:[],\r\n        goods:{},\r\n        shop:{},\r\n        detailInfo:{},\r\n        paramInfo:{},\r\n        recommend:[],\r\n        themeTopYs:[],\r\n        getThemeTopy:null,\r\n        currentIndex:0,\r\n      }\r\n    },\r\n    created() {\r\n      // 保存传入的iid\r\n      this.iid = this.$route.params.iid\r\n      // 根据iid请求数据详情页的数据\r\n      getDetail(this.iid).then((res)=>{\r\n        const data = res.result\r\n        this.topImages = data.itemInfo.topImages\r\n\r\n        // 获取商品数据\r\n        this.goods = new Goods(data.itemInfo,data.columns,data.shopInfo.services)\r\n        // 获取店铺信息\r\n        this.shop = new Shop(data.shopInfo)\r\n        // 获取下面的详情信息[因为这里的数据比较单一，没有上面两个复杂，所以没有用类保存]\r\n        this.detailInfo = data.detailInfo\r\n        // 获取商品参数信息\r\n        this.paramInfo = new GoodsParam(data.itemParams.info,data.itemParams.rule)\r\n      })\r\n      // 请求详情页中推荐数据\r\n      getRecommend().then((res)=>{\r\n        this.recommend = res.data.list\r\n      })\r\n      // 给getThemeTopY 赋值\r\n      this.getThemeTopy = debounce(()=>{\r\n        this.themeTopYs = []\r\n        this.themeTopYs.push(0)\r\n        this.themeTopYs.push(this.$refs.params.$el.offsetTop)\r\n        this.themeTopYs.push(this.$refs.comment.$el.offsetTop)\r\n        this.themeTopYs.push(this.$refs.recommend.$el.offsetTop)\r\n      },300)\r\n    },\r\n    // 混入\r\n    mixins:[itemListenerMixin,backTopmix],\r\n\r\n    mounted() {\r\n    },\r\n      // 因为这里没有进行缓存，所以离开时候调用的是destroy\r\n    destroyed() {\r\n      this.$bus.$off('imageLoads',this.itemImgListener)\r\n    },\r\n    methods:{\r\n      ...mapActions(['addCart']),\r\n      // Detail-goods-info图片加载刷新事件\r\n      imageLoader(){\r\n        this.$refs.scrollback.refresh\r\n        // 图片加载完以后进行调用获取高度\r\n        this.getThemeTopy()\r\n      },\r\n      // 监听导航栏点击事件\r\n      titleClicker(index){\r\n        this.$refs.scrollback.scrollTos(0,-this.themeTopYs[index],200)\r\n      },\r\n      // 监听页面滚动的时间\r\n      contentScroll(position){\r\n        // 获取position中的y值\r\n        const y = -position.y\r\n        //判断nav和页面的匹配\r\n        let length = this.themeTopYs.length\r\n        for (let i=0;i<length;i++){\r\n          if (this.currentIndex !== i && (i<length-1 && y>=this.themeTopYs[i] && y<this.themeTopYs[i+1] )||(i === length-1 &&\r\n              y>=this.themeTopYs[i])){\r\n                this.currentIndex = i\r\n                this.$refs.nav.currentIndex = this.currentIndex\r\n          }\r\n        }\r\n        this.listenerShowBackTop(position)\r\n      },\r\n      // 监听添加到购物车\r\n      addToCart(){\r\n        const product = {}\r\n        product.image = this.topImages[0]\r\n        product.title = this.goods.title\r\n        product.desc = this.goods.desc\r\n        product.price = this.goods.realPrice\r\n        product.iid = this.iid\r\n        // 将商品添加到购物车\r\n        // Actions返回promise\r\n        // this.$store.dispatch('addCart',product).then(res=>{\r\n        //   console.log(res);\r\n        // })\r\n\r\n        // 将商品添加到购物车【使用Actions映射】\r\n        this.addCart(product).then(res=>{\r\n          this.$toast.show(res, 1500)\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .details{\r\n    position: relative;\r\n    z-index: 9;\r\n    background-color: white;\r\n    height: 100vh;\r\n  }\r\n  .content{\r\n    height: calc(100% - 44px - 55px);\r\n  }\r\n  .detail-nav{\r\n    position: relative;\r\n    z-index: 9;\r\n    background-color: white;\r\n  }\r\n</style>"]}]}